% Constants
Pi = 3.14159265359

%kalman
laser "localize"
laser "push t='1.0' cmd='localize'"
wait 1


xEnd=4.5
yEnd=4.5

% Update the robots position in world coordinates
label "updateWorld"
invtrans $l0 $l1 $l2 $odox $odoy $odoth
wait 1 
xCur = $res0
yCur = $res1
thCur = $res2
eval xCur
eval yCur
eval thCur

% movement 
label "go"
laser "findroute startx=xCur starty=yCur endx=xEnd endy=yEnd"
wait 1

pn = $l4
eval pn
label "loop"
stringcat "getpoint p="pn
laser "$string"
wait 1
x=$l5
y=$l6
th=($l7/Pi)*180
eval x
eval y
eval th

ignoreobstacles
drivew x y th:($targetdist<0.15)

pn=pn-1
if (pn>-1) "loop"

